# 1.3. Качество данных

## Оцените, насколько качественные данные хранятся в источнике.
Опишите, как вы проверяли исходные данные и какие выводы сделали.
1) Проверили таблицы users и orders на наличие дублей:

select count(id), count (distinct id) from users;
select count(order_id), count (distinct order_id) from orders;

Данные в count и count distinct совпадают, дублей нет.

2) Проверили колонки, необходимые для рассчета витрины, на наличие null:
   select payment 
   from orders
   where payment is null; - нет null в payment

   select order_ts  
   from orders
   where order_ts  is null; - нет null в order_ts

   в принципе. данные проверки избыточны, так как в properties можно увидеть, что у всех колонок стоит ограничение not null и у всех колонок платежей дефолтное значение 0

3) проверили, что все пользователи делали заказ: все из таблицы users присутствуют в orders и нет пользователей без заказов:
select u.id, o.order_id
from users u 
left join orders o 
on u.id=o.user_id
where order_id is null; 

## Укажите, какие инструменты обеспечивают качество данных в источнике.
Ответ запишите в формате таблицы со следующими столбцами:
- `Наименование таблицы` - наименование таблицы, объект которой рассматриваете.
- `Объект` - Здесь укажите название объекта в таблице, на который применён инструмент. Например, здесь стоит перечислить поля таблицы, индексы и т.д.
- `Инструмент` - тип инструмента: первичный ключ, ограничение или что-то ещё.
- `Для чего используется` - здесь в свободной форме опишите, что инструмент делает.

1) Наименование таблицы - production.orders
   Объект -  ALTER TABLE production.orders ADD CONSTRAINT orders_check CHECK ((cost = (payment + bonus_payment)));
   Инструмент - ограничение типа CHECK
   Для чего используется - для исключения ошибок в подсчете значения 

2) Наименование таблицы - production.orders
   Объект -  ALTER TABLE production.orders ADD CONSTRAINT orders_pkey PRIMARY KEY (order_id);
   Инструмент - ограничение - первичный ключ 
   Для чего используется - для обеспечения уникальности записей




  